VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Sheet1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    Debug.Print Target.Row & ", " & Target.Column
    
    If GlobalToolSwitch = True And SetStart = False And SetGoal = False Then
        If Target.Row <= size + 2 And Target.Column <= size + 2 And Target.Interior.Color <> RGB(0, 0, 0) Then
            
            Target.Cells(1, 1).Interior.Color = RGB(0, 255, 0)
            Set Start = Target.Cells(1, 1)
            
            MsgBox "終点を設定してください。"
            SetStart = True
            
        Else
            MsgBox "スタート地点は迷路内の空白のセルである必要があります。"
        End If
        
    ElseIf GlobalToolSwitch = True And SetStart = True And SetGoal = False Then
        If Target.Row <= size + 2 And Target.Column <= size + 2 And Target.Interior.Color <> RGB(0, 0, 0) And Target.Interior.Color <> RGB(0, 255, 0) Then
            
            Target.Cells(1, 1).Interior.Color = RGB(255, 0, 0)
            Set Goal = Target.Cells(1, 1)
            
            GlobalToolSwitch = False
            SetStart = False
            SetGoal = False
            
            Cells(size + 3, size + 3).Select
            
        Else
            MsgBox "ゴール地点は迷路内の空白のセルである必要があります。"
        End If
    End If
    
End Sub
